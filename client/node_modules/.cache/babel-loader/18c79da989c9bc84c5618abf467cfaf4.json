{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jonathan\\\\Desktop\\\\MERNstack\\\\project\\\\Picture-Notes\\\\client\\\\src\\\\components\\\\update-detail.component.js\";\nimport React, { Component } from 'react';\nimport DatePicker from 'react-datepicker';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst token = localStorage.getItem('token');\nconst header = {\n  headers: {\n    'auth-token': token\n  }\n};\nexport default class EditDetail extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      id: '',\n      description: '',\n      file: null,\n      date: new Date(),\n      oldImageID: '',\n      newImage: false,\n      newImageID: '',\n      photos: []\n    };\n    this.onChangeDescription = this.onChangeDescription.bind(this);\n    this.onChangeImage = this.onChangeImage.bind(this);\n    this.onSubmitImage = this.onSubmitImage.bind(this);\n    this.changeImage = this.changeImage.bind(this);\n    this.onChangeDate = this.onChangeDate.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    axios.get('/api/dashboard/details/' + this.props.match.params.id, header).then(res => {\n      this.setState({\n        id: res.data._id,\n        description: res.data.description,\n        date: new Date(res.data.date),\n        oldImageID: res.data.image,\n        newImageID: res.data.image\n      });\n    });\n    axios.get('/api/dashboard/img_data', header).then(res => this.setState({\n      photos: res.data\n    }));\n  }\n\n  changeImage(e) {\n    e.preventDefault();\n    alert('Once you click \\'Confirm Image\\', you can\\'t get back the previous image!');\n    this.setState({\n      newImage: true\n    });\n  }\n\n  onChangeDescription(e) {\n    this.setState({\n      description: e.target.value\n    });\n  }\n\n  onChangeDate(date) {\n    this.setState({\n      date\n    });\n  }\n\n  onChangeImage(e) {\n    this.setState({\n      file: e.target.files[0]\n    });\n  }\n\n  onSubmitImage(e) {\n    e.preventDefault();\n    if (this.state.oldImageID) axios.delete('/api/dashboard/img_data/' + this.state.oldImageID, header).then(res => console.log(res));\n    const image = new FormData();\n    image.append('file', this.state.file);\n    axios.post('/api/dashboard/img_data', image, header).then(res => {\n      console.log(res.data.new_img);\n      this.setState({\n        newImageID: res.data.new_img\n      });\n    });\n    document.getElementById('imageSubmitted').innerHTML = \"Photo has been submitted\";\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    const detail = {\n      username: localStorage.getItem('username'),\n      subject: localStorage.getItem('subject'),\n      description: this.state.description,\n      image: this.state.newImageID,\n      date: this.state.date\n    };\n    axios.post('/api/dashboard/details/update/' + this.state.id, detail, header).then(res => console.log(res.data));\n    localStorage.removeItem('subject');\n    window.location = '/dashboard';\n  }\n\n  render() {\n    const username = localStorage.getItem('username');\n    const subject = localStorage.getItem('subject');\n\n    function arrayBufferToBase64(buffer) {\n      var binary = '';\n      var bytes = [].slice.call(new Uint8Array(buffer));\n      bytes.forEach(b => binary += String.fromCharCode(b));\n      return window.btoa(binary);\n    }\n\n    ;\n\n    try {\n      const image = this.state.photos.filter(img => img._id === this.state.oldImageID);\n      const base64Flag = 'data:image/jpeg;base64,';\n      const imageStr = arrayBufferToBase64(image[0].img.data.data);\n      var actualImage = base64Flag + imageStr;\n    } catch {\n      actualImage = '';\n    }\n\n    const changeImage = this.state.newImage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Image: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        name: \"myImage\",\n        onChange: this.onChangeImage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.onSubmitImage,\n        children: \"Confirm Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          id: \"imageSubmitted\",\n          style: {\n            color: \"green\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n        className: \"lightbox\",\n        href: `#${actualImage}`,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: actualImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lightbox-target\",\n        id: actualImage,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: actualImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          className: \"lightbox-close\",\n          href: \"#\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Do you want to change the Image?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.changeImage,\n        children: \"Yes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Update Detail\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.onSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Username: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Subject: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: subject\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 15\n        }, this), changeImage, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Date: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(DatePicker, {\n              selected: this.state.date,\n              onChange: this.onChangeDate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Description: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            required: true,\n            className: \"form-control\",\n            value: this.state.description,\n            onChange: this.onChangeDescription\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"submit\",\n            value: \"Update Detail\",\n            className: \"btn btn-primary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Jonathan/Desktop/MERNstack/project/Picture-Notes/client/src/components/update-detail.component.js"],"names":["React","Component","DatePicker","axios","token","localStorage","getItem","header","headers","EditDetail","constructor","props","state","id","description","file","date","Date","oldImageID","newImage","newImageID","photos","onChangeDescription","bind","onChangeImage","onSubmitImage","changeImage","onChangeDate","onSubmit","componentDidMount","get","match","params","then","res","setState","data","_id","image","e","preventDefault","alert","target","value","files","delete","console","log","FormData","append","post","new_img","document","getElementById","innerHTML","detail","username","subject","removeItem","window","location","render","arrayBufferToBase64","buffer","binary","bytes","slice","call","Uint8Array","forEach","b","String","fromCharCode","btoa","filter","img","base64Flag","imageStr","actualImage","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport DatePicker from 'react-datepicker';\r\nimport 'react-datepicker/dist/react-datepicker.css';\r\nimport axios from 'axios';\r\n\r\nconst token = localStorage.getItem('token');\r\nconst header = { headers: {'auth-token': token} }\r\n\r\nexport default class EditDetail extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            id: '',\r\n            description: '',\r\n            file: null,\r\n            date: new Date(),\r\n            oldImageID: '',\r\n            newImage: false,\r\n            newImageID: '',\r\n            photos: []\r\n        }\r\n        this.onChangeDescription = this.onChangeDescription.bind(this);\r\n        this.onChangeImage = this.onChangeImage.bind(this);\r\n        this.onSubmitImage = this.onSubmitImage.bind(this);\r\n        this.changeImage = this.changeImage.bind(this);\r\n        this.onChangeDate = this.onChangeDate.bind(this);\r\n        this.onSubmit = this.onSubmit.bind(this);\r\n    }\r\n\r\n    componentDidMount(){\r\n      axios.get('/api/dashboard/details/' + this.props.match.params.id, header)\r\n        .then(res => {\r\n          this.setState({\r\n            id: res.data._id,\r\n            description: res.data.description,\r\n            date: new Date(res.data.date),\r\n            oldImageID: res.data.image,\r\n            newImageID: res.data.image\r\n          })\r\n        })\r\n\r\n      axios.get('/api/dashboard/img_data', header)\r\n        .then(res => this.setState({ photos: res.data }))\r\n    }\r\n\r\n    changeImage(e){\r\n      e.preventDefault();\r\n      alert('Once you click \\'Confirm Image\\', you can\\'t get back the previous image!');\r\n      this.setState({ newImage: true })\r\n    }\r\n\r\n    onChangeDescription(e) {\r\n      this.setState({ description: e.target.value})\r\n    }\r\n\r\n    onChangeDate(date) {\r\n        this.setState({ date })\r\n    }\r\n\r\n    onChangeImage(e){\r\n      this.setState({ file: e.target.files[0] })\r\n    }\r\n\r\n    onSubmitImage(e){\r\n      e.preventDefault();\r\n\r\n      if(this.state.oldImageID)\r\n        axios.delete('/api/dashboard/img_data/' + this.state.oldImageID, header)\r\n          .then(res => console.log(res))\r\n\r\n      const image = new FormData();\r\n      image.append('file', this.state.file);\r\n\r\n      axios.post('/api/dashboard/img_data', image, header)\r\n        .then(res => {\r\n          console.log(res.data.new_img)\r\n          this.setState({ newImageID: res.data.new_img })\r\n        })\r\n\r\n      document.getElementById('imageSubmitted').innerHTML = \"Photo has been submitted\"\r\n    }\r\n\r\n    onSubmit(e) {\r\n        e.preventDefault();\r\n\r\n        const detail = {\r\n          username: localStorage.getItem('username'),\r\n          subject: localStorage.getItem('subject'),\r\n          description: this.state.description,\r\n          image: this.state.newImageID,\r\n          date: this.state.date\r\n        };\r\n\r\n        axios.post('/api/dashboard/details/update/' + this.state.id, detail, header)\r\n            .then(res => console.log(res.data))\r\n\r\n        localStorage.removeItem('subject');\r\n        window.location = '/dashboard';\r\n    }\r\n\r\n    render() {\r\n        const username = localStorage.getItem('username')\r\n        const subject = localStorage.getItem('subject');\r\n\r\n        function arrayBufferToBase64(buffer) {\r\n          var binary = '';\r\n          var bytes = [].slice.call(new Uint8Array(buffer));\r\n          bytes.forEach((b) => binary += String.fromCharCode(b));\r\n          return window.btoa(binary);\r\n        };\r\n\r\n        try{\r\n          const image = this.state.photos.filter(img => img._id === this.state.oldImageID)\r\n          const base64Flag = 'data:image/jpeg;base64,';\r\n          const imageStr = arrayBufferToBase64(image[0].img.data.data)\r\n          var actualImage = base64Flag + imageStr\r\n        }\r\n        catch{\r\n            actualImage = '';\r\n        }\r\n\r\n        const changeImage = (this.state.newImage)\r\n          ? <div className=\"form-group\"> \r\n              <label>Image: </label>\r\n              <br />\r\n              <input type=\"file\" name=\"myImage\" onChange= {this.onChangeImage} />\r\n              <button onClick={this.onSubmitImage}>Confirm Image</button>\r\n              <div>\r\n                <label id=\"imageSubmitted\" style={{color: \"green\"}}></label>\r\n              </div>\r\n            </div>\r\n          : <div className=\"form-group\"> \r\n              <label>Image</label>\r\n              <a className=\"lightbox\" href={`#${actualImage}`}>\r\n                <img src={actualImage}/>\r\n              </a> \r\n              <div className=\"lightbox-target\" id={actualImage}>\r\n                <img src={actualImage}/>\r\n                <a className=\"lightbox-close\" href=\"#\" />\r\n              </div>\r\n              <div>Do you want to change the Image?</div>\r\n              <button onClick={this.changeImage}>Yes</button>\r\n            </div>\r\n        return (\r\n          <div className='container'>\r\n            <h3>Update Detail</h3>\r\n            <form onSubmit={this.onSubmit}>\r\n              <div className=\"form-group\"> \r\n                <label>Username: </label>\r\n                <h5>{username}</h5>\r\n              </div>\r\n              <br />\r\n              <div className=\"form-group\"> \r\n                <label>Subject: </label>\r\n                <h5>{subject}</h5>\r\n              </div>\r\n              <br />\r\n              {changeImage}\r\n              <br />\r\n              <div className=\"form-group\">\r\n                <label>Date: </label>\r\n                <div>\r\n                  <DatePicker\r\n                    selected={this.state.date}\r\n                    onChange={this.onChangeDate}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <br />\r\n              <div className=\"form-group\"> \r\n                <label>Description: </label>\r\n                <input  type=\"text\"\r\n                    required\r\n                    className=\"form-control\"\r\n                    value={this.state.description}\r\n                    onChange={this.onChangeDescription}\r\n                    />\r\n              </div>\r\n              <br />\r\n              <div className=\"form-group\">\r\n                <input type=\"submit\" value=\"Update Detail\" className=\"btn btn-primary\" />\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )\r\n    }\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}