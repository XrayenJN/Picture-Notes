{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jonathan\\\\Desktop\\\\MERNstack\\\\project\\\\Picture-Notes\\\\client\\\\src\\\\components\\\\dashboard.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst token = localStorage.getItem('token');\nconst header = {\n  headers: {\n    'auth-token': token\n  }\n};\nexport default class Dashboard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      subjects: [],\n      subjectClicked: '',\n      details: [],\n      sorted: false,\n      photo: []\n    };\n    this.subjectClicked = this.subjectClicked.bind(this);\n    this.sort = this.sort.bind(this);\n  }\n\n  arrayBufferToBase64(buffer) {\n    var binary = '';\n    var bytes = [].slice.call(new Uint8Array(buffer));\n    bytes.forEach(b => binary += String.fromCharCode(b));\n    return window.btoa(binary);\n  }\n\n  subjectClicked(e) {\n    this.setState({\n      subjectClicked: e.target.innerText\n    });\n    localStorage.setItem(\"subject\", e.target.innerText);\n  }\n\n  deleteDetail(e, id, imgID) {\n    e.preventDefault();\n    axios.delete('/api/dashboard/details/' + id, header).then(res => console.log(res.data));\n    axios.delete('/api/dashboard/img_data/' + imgID, header).then(res => console.log(res.data));\n    this.setState({\n      details: this.state.details.filter(each => each._id !== id),\n      photo: this.state.photo.filter(each => each._id !== imgID)\n    });\n  }\n\n  sort(e) {\n    const sorted = this.state.details.sort((first, second) => {\n      if (this.state.sorted === true) {\n        if (first.date > second.date) return 1;\n        return -1;\n      } else {\n        if (first.date > second.date) return -1;\n        return 1;\n      }\n    });\n    this.setState({\n      details: sorted,\n      sorted: !this.state.sorted\n    });\n  }\n\n  componentDidMount() {\n    axios.get('/api/dashboard/subjects', header).then(response => {\n      const subjects = response.data.filter(each => each.username === localStorage.getItem('username'));\n      const subject = subjects.map(each => each.subject);\n      this.setState({\n        subjects: subject\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n    axios.get('/api/dashboard/details', header).then(res => {\n      this.setState({\n        details: res.data\n      });\n    });\n    axios.get('/api/dashboard/img_data', header).then(res => {\n      const photos = res.data;\n      this.setState({\n        photos\n      });\n    });\n  }\n\n  render() {\n    const subjects = this.state.subjects;\n    const listSubjects = subjects.map(subject => /*#__PURE__*/_jsxDEV(\"tr\", {\n      onClick: this.subjectClicked,\n      children: /*#__PURE__*/_jsxDEV(\"th\", {\n        children: subject\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)\n    }, subject, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this));\n    var details = this.state.details;\n    var sortedDetails = details.filter(each => each.username === localStorage.getItem('username') && each.subject === this.state.subjectClicked);\n    var number = 0;\n    var listDetails = sortedDetails.map(detail => {\n      try {\n        const photos = this.state.photos;\n        var imageID = detail.image;\n        const image = photos.filter(each => each._id === imageID);\n        const base64Flag = 'data:image/jpeg;base64,';\n        const imageStr = this.arrayBufferToBase64(image[0].img.data.data);\n        var actualImage = base64Flag + imageStr;\n      } catch {\n        actualImage = '';\n      }\n\n      number++;\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n          children: number\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: detail.date.substring(0, 10)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: detail.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            className: \"lightbox\",\n            href: `#${actualImage}`,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: actualImage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lightbox-target\",\n            id: actualImage,\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: actualImage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"lightbox-close\",\n              href: \"#\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: \"/detail/edit/\" + detail._id,\n            children: \"edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 25\n          }, this), \"|\", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"/dashboard\",\n            onClick: e => this.deleteDetail(e, detail._id, imageID),\n            children: \"delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this)]\n      }, detail._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-xs\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    children: \"Subject\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: [listSubjects, /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/subject/add\",\n                      className: \"nav-link\",\n                      children: \"+Subject\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 153,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              children: this.state.subjectClicked\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    children: \"No.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 163,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    children: [\"Date\", /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: e => this.sort(e),\n                      children: \"\\u2191\\u2193\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 164,\n                      columnNumber: 61\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    children: \"Description\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\",\n                    children: \"Image\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    scope: \"col\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: [listDetails, /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/detail/add\",\n                      className: \"nav-link\",\n                      children: \"+Detail\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 173,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 172,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Jonathan/Desktop/MERNstack/project/Picture-Notes/client/src/components/dashboard.component.js"],"names":["React","Component","axios","Link","token","localStorage","getItem","header","headers","Dashboard","constructor","props","state","subjects","subjectClicked","details","sorted","photo","bind","sort","arrayBufferToBase64","buffer","binary","bytes","slice","call","Uint8Array","forEach","b","String","fromCharCode","window","btoa","e","setState","target","innerText","setItem","deleteDetail","id","imgID","preventDefault","delete","then","res","console","log","data","filter","each","_id","first","second","date","componentDidMount","get","response","username","subject","map","catch","error","photos","render","listSubjects","sortedDetails","number","listDetails","detail","imageID","image","base64Flag","imageStr","img","actualImage","substring","description"],"mappings":"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","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst token = localStorage.getItem('token');\r\nconst header = { headers: {'auth-token': token} }\r\n\r\nexport default class Dashboard extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            subjects: [],\r\n            subjectClicked: '',\r\n            details: [],\r\n            sorted: false,\r\n            photo: [],\r\n        };\r\n\r\n        this.subjectClicked = this.subjectClicked.bind(this)\r\n        this.sort = this.sort.bind(this);\r\n    }\r\n\r\n    arrayBufferToBase64(buffer) {\r\n        var binary = '';\r\n        var bytes = [].slice.call(new Uint8Array(buffer));\r\n        bytes.forEach((b) => binary += String.fromCharCode(b));\r\n        return window.btoa(binary);\r\n    };\r\n\r\n    subjectClicked(e) {\r\n        this.setState({subjectClicked: e.target.innerText})\r\n        localStorage.setItem(\"subject\", e.target.innerText)\r\n    }\r\n\r\n    deleteDetail(e, id, imgID) {\r\n        e.preventDefault();\r\n\r\n        axios.delete('/api/dashboard/details/' + id, header)\r\n            .then(res => console.log(res.data))\r\n\r\n        axios.delete('/api/dashboard/img_data/' + imgID, header)\r\n            .then(res => console.log(res.data));\r\n\r\n        this.setState({\r\n            details: this.state.details.filter(each => each._id !== id),\r\n            photo: this.state.photo.filter(each => each._id !== imgID)\r\n        })\r\n    }\r\n\r\n    sort(e){\r\n        const sorted = this.state.details.sort((first, second) => {\r\n            if (this.state.sorted === true) {\r\n                if (first.date > second.date) return 1\r\n                    return -1\r\n            } else {if (first.date > second.date) return -1\r\n                    return 1\r\n            }\r\n        })\r\n        this.setState({ details: sorted, sorted: !this.state.sorted });\r\n    }\r\n\r\n    componentDidMount() {\r\n        axios.get('/api/dashboard/subjects', header)\r\n          .then(response => {\r\n            const subjects = response.data.filter(each => \r\n                each.username === localStorage.getItem('username')\r\n            )\r\n            const subject = subjects.map(each => each.subject)\r\n            this.setState({ subjects: subject})\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          })\r\n\r\n        axios.get('/api/dashboard/details', header)\r\n            .then(res => {\r\n                this.setState({ details: res.data })\r\n            })\r\n\r\n        axios.get('/api/dashboard/img_data', header)\r\n            .then(res => {\r\n                const photos = res.data;\r\n                this.setState({ photos })\r\n            })\r\n    }\r\n\r\n    render() {\r\n        const subjects = this.state.subjects\r\n        const listSubjects = subjects.map(subject => \r\n            <tr key={subject} onClick={this.subjectClicked}>\r\n                <th>{subject}</th>\r\n            </tr>\r\n            )\r\n\r\n        var details = this.state.details\r\n        var sortedDetails = details.filter(each => \r\n            each.username === localStorage.getItem('username')\r\n            && each.subject === this.state.subjectClicked\r\n            );\r\n\r\n        var number = 0;\r\n        var listDetails = sortedDetails.map(detail => {\r\n            try {\r\n                const photos = this.state.photos\r\n                var imageID = detail.image\r\n                const image = photos.filter(each => each._id === imageID)\r\n                const base64Flag = 'data:image/jpeg;base64,';\r\n                const imageStr = this.arrayBufferToBase64(image[0].img.data.data)\r\n                var actualImage = base64Flag + imageStr\r\n            }\r\n            catch{\r\n                actualImage = '';\r\n            }\r\n            number++;\r\n            return(\r\n                <tr key={detail._id}>\r\n                    <td>{number}</td>\r\n                    <td>{detail.date.substring(0,10)}</td>\r\n                    <td>{detail.description}</td>\r\n                    <td>\r\n                        <a className=\"lightbox\" href={`#${actualImage}`}>\r\n                            <img src={actualImage}/>\r\n                        </a> \r\n                        <div className=\"lightbox-target\" id={actualImage}>\r\n                            <img src={actualImage}/>\r\n                            <a className=\"lightbox-close\" href=\"#\" />\r\n                        </div>\r\n                    </td>\r\n                    <td>\r\n                        <Link to={\"/detail/edit/\"+detail._id}>edit</Link> \r\n                        | \r\n                        <a href=\"/dashboard\" onClick={(e) => this.deleteDetail(e, detail._id, imageID)}>delete</a>\r\n                    </td>\r\n                </tr>\r\n            )\r\n        })\r\n        return (\r\n            <div className='container-fluid'>\r\n                <div>\r\n                    <div className=\"row\">\r\n                        <div className=\"col-xs\">\r\n                            <table className=\"table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th scope=\"col\">Subject</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {listSubjects}\r\n                                    <tr>\r\n                                        <th><Link to=\"/subject/add\" className=\"nav-link\">+Subject</Link></th>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                        <div className=\"col\">\r\n                            <h1>{this.state.subjectClicked}</h1>\r\n                            <table className='table'>\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th scope='col'>No.</th>\r\n                                        <th scope='col'>Date<button onClick={(e) => this.sort(e)}>↑↓</button></th>\r\n                                        <th scope='col'>Description</th>\r\n                                        <th scope='col'>Image</th>\r\n                                        <th scope=\"col\"></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {listDetails}\r\n                                    <tr>\r\n                                        <th><Link to=\"/detail/add\" className=\"nav-link\">+Detail</Link></th>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}